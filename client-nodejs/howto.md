- Сначала мы ищем лица на изображении. Используется Свёрточная Нейронная Сеть (CNN). Конкретная модель TinyFaceDetector. Эта модель ищет bounding box (границы лицаБ по сути прямоугольник). Модель обучена на огромном датасете лиц. Определяет, где именно находится лицо.
- Следующий этап, это определение опорных точек (landmarks) через модель FaceLandmark68TinyNet. Нейросеть берет область, тот самый прямоугольник из предыдущего этапа. Определяет 68 точек на лице:
  - Контур лица (17 точек),
  - Брови (10 точек),
  - Нос (9 точек),
  - Глаза (12 точек),
  - Губы (20 точек).
    Текущая модель определяет схематику лица.
- Последний этап - создание дескриптора из 68 точек из предыдущего этапа. Дескриптор, они же эмбеддинги, представляет из себя набор признаков. Признак — это индивидуальное измеримое свойство в записанном наборе данных. Их особенность в том, что их понимает только сама нейросеть. В нашем случае, вектор эмбеддингов (признаков/дескрипторов), состоит из 128 чисел. Два похожих лица будут иметь небольшое расстояние (косинусное расстояние). Используемая модель - на основе ResNet.

### Почему именно 128 чисел?

- Оптимальный баланс между:
  - Точностью распознавания
  - Вычислительной сложностью
  - Размером данных
- Опытным путём установлено (исходно из статьи FaceNet от Google)
- Можно представить как 128-мерную гиперсферу, где:
  - Каждое лицо — точка на сфере
  - Похожие лица группируются рядом

### Как используется в коде?

- Регистрация:

  - Получаем вектор → сохраняем как эталон для имени

- Авторизация: - Получаете новый вектор → сравниваете с сохранённым эталоном

Сравнение через косинусное расстояние:

```
const distance = faceapi.euclideanDistance(vec1, vec2);
if(distance < 0.6) { // пороговое значение
  // это тот же человек
}
```
